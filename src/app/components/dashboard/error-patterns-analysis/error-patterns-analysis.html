<div class="error-patterns-analysis">
  <div class="widget-header">
    <h3 class="widget-title">Error Patterns</h3>
    <p class="widget-subtitle">Common mistakes to focus on</p>
  </div>

  @if (data().length === 0) {
    <div class="empty-state">
      <div class="success-icon">ðŸŽ‰</div>
      <p class="success-message">Excellent work!</p>
      <p class="success-hint">No significant error patterns detected. Keep up the great work!</p>
    </div>
  } @else {
    <div class="error-list">
      @for (error of data(); track error.type) {
        <div class="error-card" [class]="getErrorColor(error.type)">
          <div class="error-header">
            <div class="error-info">
              <span class="error-icon">{{ getErrorIcon(error.type) }}</span>
              <div class="error-details">
                <h4 class="error-type">{{ error.description }}</h4>
                <div class="error-stats">
                  <span class="error-count">{{ error.count }} occurrences</span>
                  <span class="error-percentage" [class]="getSeverityClass(error.percentage)">
                    {{ error.percentage }}% of all errors
                  </span>
                </div>
              </div>
            </div>
          </div>

          <div class="error-recommendation">
            <svg class="recommendation-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="recommendation-text">{{ error.recommendation }}</p>
          </div>

          @if (error.examples && error.examples.length > 0) {
            <div class="error-examples">
              <h5 class="examples-title">Examples:</h5>
              <ul class="examples-list">
                @for (example of error.examples; track $index) {
                  <li class="example-item">{{ example }}</li>
                }
              </ul>
            </div>
          }
        </div>
      }
    </div>

    <div class="improvement-tip">
      <svg class="tip-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
      </svg>
      <p>Focus on your most frequent error types to see the biggest improvement in your scores.</p>
    </div>
  }
</div>
