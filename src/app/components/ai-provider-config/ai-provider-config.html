<div class="config-section">
  <h2>AI Provider Configuration</h2>
  <p class="section-description">Choose your preferred AI provider and configure credentials</p>

  <!-- Provider Cards -->
  <div class="provider-cards">


    <!-- OpenAI Card -->
    <div class="provider-card" [class.selected]="config().provider === 'openai'"
      [class.expanded]="expandedProvider() === 'openai'">
      <div class="card-header" (click)="toggleProvider('openai')">
        <div class="card-title">
          <span class="provider-icon">ğŸŸ¢</span>
          <div>
            <h3>OpenAI</h3>
            <p class="provider-desc">Direct access to GPT models</p>
          </div>
        </div>
        <div class="card-actions">
          @if (config().provider === 'openai') {
          <span class="active-badge">Active</span>
          }
          <button type="button" class="expand-btn" [class.expanded]="expandedProvider() === 'openai'">
            {{ expandedProvider() === 'openai' ? 'â–¼' : 'â–¶' }}
          </button>
        </div>
      </div>

      @if (expandedProvider() === 'openai') {
      <div class="card-content">
        <div class="form-group">
          <label for="openai-key">API Key</label>
          <div class="input-with-toggle">
            <input id="openai-key" [type]="showApiKeys().openai ? 'text' : 'password'"
              [ngModel]="config().openai.apiKey" (ngModelChange)="updateOpenAIApiKey($event)" placeholder="sk-..." />
            <button type="button" class="toggle-visibility" (click)="toggleApiKeyVisibility('openai')"
              aria-label="Toggle API key visibility">
              {{ showApiKeys().openai ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
            </button>
          </div>
          <small>Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank"
              rel="noopener">OpenAI Platform</a></small>
        </div>

        <div class="form-group">
          <label for="openai-model">Model</label>
          <select id="openai-model" [ngModel]="config().openai.modelName" (ngModelChange)="updateOpenAIModel($event)">
            <option value="gpt-5">GPT-5</option>
            <option value="gpt-5-mini">GPT-5 Mini</option>
            <option value="gpt-5-nano">GPT-5 Nano</option>
            <option value="gpt-4o">GPT-4o</option>
            <option value="gpt-4o-mini">GPT-4o Mini</option>
          </select>
        </div>

        <button class="btn btn-select" (click)="selectProvider('openai')">
          Use OpenAI
        </button>
      </div>
      }
    </div>

    <!-- Google Gemini Card -->
    <div class="provider-card" [class.selected]="config().provider === 'gemini'"
      [class.expanded]="expandedProvider() === 'gemini'">
      <div class="card-header" (click)="toggleProvider('gemini')">
        <div class="card-title">
          <span class="provider-icon">ğŸ”¶</span>
          <div>
            <h3>Google Gemini</h3>
            <p class="provider-desc">Google's multimodal AI model</p>
          </div>
        </div>
        <div class="card-actions">
          @if (config().provider === 'gemini') {
          <span class="active-badge">Active</span>
          }
          <button type="button" class="expand-btn" [class.expanded]="expandedProvider() === 'gemini'">
            {{ expandedProvider() === 'gemini' ? 'â–¼' : 'â–¶' }}
          </button>
        </div>
      </div>

      @if (expandedProvider() === 'gemini') {
      <div class="card-content">
        <div class="form-group">
          <label for="gemini-key">API Key</label>
          <div class="input-with-toggle">
            <input id="gemini-key" [type]="showApiKeys().gemini ? 'text' : 'password'"
              [ngModel]="config().gemini.apiKey" (ngModelChange)="updateGeminiApiKey($event)"
              placeholder="Enter your Gemini API key" />
            <button type="button" class="toggle-visibility" (click)="toggleApiKeyVisibility('gemini')"
              aria-label="Toggle API key visibility">
              {{ showApiKeys().gemini ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
            </button>
          </div>
          <small>Get your API key from <a href="https://makersuite.google.com/app/apikey" target="_blank"
              rel="noopener">Google AI Studio</a></small>
        </div>

        <div class="form-group">
          <label for="gemini-model">Model</label>
          <select id="gemini-model" [ngModel]="config().gemini.modelName" (ngModelChange)="updateGeminiModel($event)">
            <option value="gemini-2.5-pro">Gemini 2.5 Pro (Latest)</option>
            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
            <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash Experimental</option>
            <option value="gemini-exp-1206">Gemini Exp 1206</option>
          </select>
        </div>

        <button class="btn btn-select" (click)="selectProvider('gemini')">
          Use Google Gemini
        </button>
      </div>
      }
    </div>

    <!-- Azure OpenAI Card -->
    <div class="provider-card" [class.selected]="config().provider === 'azure'"
      [class.expanded]="expandedProvider() === 'azure'">
      <div class="card-header" (click)="toggleProvider('azure')">
        <div class="card-title">
          <span class="provider-icon">ğŸ”·</span>
          <div>
            <h3>Azure OpenAI</h3>
            <p class="provider-desc">Enterprise-grade AI with enhanced security</p>
          </div>
        </div>
        <div class="card-actions">
          @if (config().provider === 'azure') {
          <span class="active-badge">Active</span>
          }
          <button type="button" class="expand-btn" [class.expanded]="expandedProvider() === 'azure'">
            {{ expandedProvider() === 'azure' ? 'â–¼' : 'â–¶' }}
          </button>
        </div>
      </div>

      @if (expandedProvider() === 'azure') {
      <div class="card-content">
        <div class="form-group">
          <label for="azure-endpoint">Endpoint URL</label>
          <input id="azure-endpoint" type="text" [ngModel]="config().azure.endpoint"
            (ngModelChange)="updateAzureEndpoint($event)" placeholder="https://your-resource.openai.azure.com/" />
        </div>

        <div class="form-group">
          <label for="azure-key">API Key</label>
          <div class="input-with-toggle">
            <input id="azure-key" [type]="showApiKeys().azure ? 'text' : 'password'" [ngModel]="config().azure.apiKey"
              (ngModelChange)="updateAzureApiKey($event)" placeholder="Enter your Azure OpenAI API key" />
            <button type="button" class="toggle-visibility" (click)="toggleApiKeyVisibility('azure')"
              aria-label="Toggle API key visibility">
              {{ showApiKeys().azure ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="azure-deployment">Deployment Name</label>
          <input id="azure-deployment" type="text" [ngModel]="config().azure.deploymentName"
            (ngModelChange)="updateAzureDeployment($event)" placeholder="gpt-4" />
        </div>

        <button class="btn btn-select" (click)="selectProvider('azure')">
          Use Azure OpenAI
        </button>
      </div>
      }
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button class="btn btn-primary" (click)="saveConfig()">
      ğŸ’¾ Save Configuration
    </button>
    <button class="btn btn-secondary" (click)="clearConfig()">
      ğŸ—‘ï¸ Clear All
    </button>
  </div>

  <!-- Messages -->
  @if (saveSuccess()) {
  <div class="message success">
    âœ… Configuration saved successfully!
  </div>
  }
  @if (saveError()) {
  <div class="message error">
    âŒ Failed to save configuration. Please try again.
  </div>
  }

  <!-- Info Box -->
  <div class="info-box">
    <h4>ğŸ”’ Privacy & Security</h4>
    <p>
      Your API keys are stored locally in your browser and never sent to any server except the AI provider you
      configure.
    </p>
  </div>
</div>