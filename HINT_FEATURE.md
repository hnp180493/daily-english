# AI-Powered Hint Feature

## Overview
The hint system provides **dynamic, AI-generated** contextual assistance to learners during translation exercises. Unlike static hints, each hint is generated in real-time based on the user's current translation attempt and previous hints.

## Implementation Details

### Component State (exercise-detail.ts)
- **hintsShown**: Signal tracking the number of hints displayed (max 3 per sentence)
- **currentHint**: Signal storing the currently displayed hint text
- **previousHints**: Signal array storing all hints shown for current sentence
- **isLoadingHint**: Signal indicating hint generation in progress
- **hasMoreHints**: Computed property checking if additional hints are available (max 3)

### User Flow
1. User attempts to translate a sentence
2. If stuck, clicks the "üí° Hint (0/3)" button
3. AI analyzes the source text and user's current input
4. First hint appears in the hint card
5. User can request up to 3 progressive hints per sentence
6. Each hint becomes more specific based on previous hints
7. Hints reset when moving to the next sentence

### AI Hint Generation
- **Dynamic Generation**: Each hint is generated by AI based on:
  - Source text (original sentence)
  - User's current translation attempt
  - Previous hints already shown
  - Exercise difficulty level and category
- **Progressive Hints**: Later hints are more specific than earlier ones
- **Context-Aware**: AI considers what the user has already tried

### API Integration

#### AI Service Method
```typescript
generateHint(
  sourceText: string,
  userInput: string,
  previousHints: string[],
  exercise: Exercise
): Observable<string>
```

#### Provider Implementation
All three AI providers support hint generation:
- **Azure OpenAI**: Uses GPT-4 with custom prompt
- **Google Gemini**: Uses gemini-pro model
- **OpenAI**: Uses GPT-4 API

#### Hint Generation Prompt
The AI is instructed to:
- Provide ONE specific, progressive hint
- Be different from previous hints
- Be more specific if not the first hint
- Focus on grammar, vocabulary, or structure
- Not give away the complete answer
- Be encouraging and educational

### UI Components

#### Hint Button with Loading State
```html
<button 
  class="action-btn hint-btn" 
  (click)="onHint()" 
  [disabled]="!hasMoreHints() || isLoadingHint()">
  @if (isLoadingHint()) {
    <span>‚è≥ Loading...</span>
  } @else {
    <span>üí° Hint ({{ hintsShown() }}/3)</span>
  }
</button>
```

#### Hint Display Card
```html
@if (currentHint()) {
  <div class="section-card hint-card">
    <h3 class="section-title">üí° Hint</h3>
    <p class="hint-text">{{ currentHint() }}</p>
  </div>
}
```

### Styling
- Hint card has distinctive yellow left border (#f5b800)
- Dark background (#2a2d4a) for contrast
- Appears in the right column below feedback

### Progress Tracking
- Number of hints used is recorded in ExerciseAttempt
- All hints saved to localStorage with in-progress state
- Restored when user returns to incomplete exercise
- Hint history preserved for current sentence

### State Persistence
```typescript
{
  sentences: SentenceProgress[],
  currentIndex: number,
  hintsShown: number,
  previousHints: string[],
  currentHint: string,
  currentInput: string
}
```

## Example AI-Generated Hints

### Scenario 1: User hasn't started typing
**Source**: "H√¥m nay l√† m·ªôt ng√†y b·∫≠n r·ªôn v·ªõi t√¥i"
**User Input**: ""

**Hint 1**: "Start by identifying the time marker 'H√¥m nay' - what's the English equivalent?"
**Hint 2**: "Think about how to express 'busy day' in English. What preposition goes with 'busy'?"
**Hint 3**: "The phrase 'v·ªõi t√¥i' means 'for me'. Consider the complete structure: [Time] is a busy day for me."

### Scenario 2: User has partial translation
**Source**: "T√¥i kh√¥ng th·ªÉ ch·ªù ƒë·ª£i ƒë·ªÉ kh√°m ph√° nh·ªØng n∆°i m·ªõi"
**User Input**: "I can not wait to explore new place"

**Hint 1**: "Good start! Check your spelling of 'cannot' - is it one word or two?"
**Hint 2**: "Look at 'new place' - should 'place' be singular or plural when talking about multiple locations?"
**Hint 3**: "Almost perfect! 'Cannot' should be one word, and 'places' should be plural."

### Scenario 3: Advanced level
**Source**: "Ranh gi·ªõi gi·ªØa c√¥ng vi·ªác v√† cu·ªôc s·ªëng c√° nh√¢n ƒëang ng√†y c√†ng m·ªù nh·∫°t"
**User Input**: "The boundary between work and personal life is blurred"

**Hint 1**: "Your translation is good, but consider the progressive nature implied by 'ƒëang ng√†y c√†ng' - is this a completed state or an ongoing process?"
**Hint 2**: "Think about using present continuous tense to show this is an ongoing change: 'is becoming...'"
**Hint 3**: "Consider adding 'increasingly' to capture the 'ng√†y c√†ng' (more and more) aspect of the change."

## Accessibility
- Button has proper disabled state
- Focus indicators on hint button
- Semantic HTML structure
- Clear visual hierarchy

## Advantages of AI-Generated Hints

1. **Contextual**: Hints are based on what the user actually typed, not generic
2. **Progressive**: Each hint builds on previous ones and becomes more specific
3. **Adaptive**: Different users get different hints based on their attempts
4. **Unlimited Variety**: No need to pre-write hints for every exercise
5. **Intelligent**: AI understands the nuances of both languages
6. **Educational**: Hints teach concepts rather than just giving answers

## Error Handling
- Loading state shown while generating hint
- Error message displayed if API call fails
- Button disabled during hint generation
- Graceful fallback if AI service unavailable

## Performance Considerations
- Hints generated on-demand (not pre-fetched)
- Average response time: 1-3 seconds
- Cached in component state for current sentence
- Cleared when moving to next sentence

## Future Enhancements
- Hint cost system (deduct points for using hints)
- Hint quality ratings from users
- Learning from user feedback to improve hints
- Audio hints for pronunciation guidance
- Hint analytics to identify common struggles
